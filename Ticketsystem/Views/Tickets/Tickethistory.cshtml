@model List<TicketViewModel>

@inject UserManager<User> userManager;
@inject IServiceFactory serviceFactory;

@{
    var rolePermissionsService = serviceFactory.GetRolePermissionsService();
    var loggedInUser = await userManager.GetUserAsync(User);
    if (loggedInUser == null)
    {
        Context.Response.Redirect("/Identity/Account/Login");
        return;
    }
    if (!await rolePermissionsService.HasPermission(loggedInUser, RolePermissions.ViewHistory))
    {
        Context.Response.Redirect("/Home/PermissionError");
        return;
    }
}

@*
For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

<h1>Works</h1>
